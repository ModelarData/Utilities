#!/bin/sh

# A pre-commit hook that ensures a Rust project contains no errors or warnings.

# Fail if any of the cargo commands fails.
set -e

# Ensure that the compiler (cargo build), the linter (cargo clippy), the
# documentation generator (cargo doc), the unit tests (cargo test), and the
# integration tests (cargo test) does not emit any errors or warnings.
echo "cargo build"
RUSTFLAGS="-D warnings" cargo build
echo
echo "cargo clippy"
RUSTFLAGS="-D warnings" cargo clippy
echo
echo "cargo doc"
RUSTDOCFLAGS="-D warnings" cargo doc
echo
echo "cargo test"
RUSTFLAGS="-D warnings" cargo test
